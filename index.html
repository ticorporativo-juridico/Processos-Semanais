<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Semanal de Processos</title>
    <!-- Carrega o Tailwind CSS para um layout moderno e responsivo -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Configura√ß√£o de Fonte Padr√£o e Estilos Globais */
        :root {
            /* Cor prim√°ria agora √© um Cinza Chumbo (Slate) */
            --color-primary: #475569; 
            --color-secondary: #64748b; 
            --color-bg: #f8fafc; /* Super Light Gray */
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--color-bg);
        }
        /* Estilos customizados para as colunas do Kanban */
        .board-column {
            min-width: 300px;
            max-width: 350px;
            flex-shrink: 0;
            /* Estilo da coluna para profundidade */
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.06);
        }
        .task-card {
            transition: transform 0.2s, box-shadow 0.3s;
            border-left-width: 6px; /* Borda mais grossa */
            border-radius: 0.75rem; /* Cantos mais arredondados */
        }
        .task-card:hover {
            transform: translateY(-3px); /* Efeito 3D sutil */
            box-shadow: 0 15px 25px -5px rgba(0, 0, 0, 0.1), 0 5px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        /* Cores de status em tons neutros e discretos */
        /* Tratamento (Muted Amber/Gold) */
        .status-tratamento { border-left-color: #d97706; } 
        /* Tratados (Muted Sage/Teal) */
        .status-tratados { border-left-color: #059669; } 
        /* Pr√≥ximos (Soft Sky Blue/Slate) */
        .status-proximos { border-left-color: #0ea5e9; } 

        /* Estilo para a data no card */
        .card-date {
            background-color: #f0f4f8; /* Cinza super claro */
            color: #475569; /* Cinza Chumbo */
            padding: 2px 8px;
            border-radius: 9999px; /* Pill shape */
            font-weight: 600;
        }
    </style>
</head>
<body class="p-4 sm:p-8">

    <!-- Cabe√ßalho Principal Moderno com Gradient Neutro (Cinzas) -->
    <header class="bg-gradient-to-r from-slate-700 to-gray-500 rounded-xl shadow-xl p-8 mb-8 text-center">
        <h1 class="text-4xl font-black text-white">Dashboard de Acompanhamento Semanal</h1>
        <p class="text-slate-200 mt-2 text-lg">Vis√£o din√¢mica dos processos da equipe.</p>
    </header>

    <!-- Se√ß√£o de Filtros com Layout Mais Elegante -->
    <div class="bg-white rounded-xl shadow-lg p-6 mb-8 flex flex-wrap gap-4 items-end border-t-4 border-slate-400">
        <h2 class="text-xl font-bold text-slate-700 w-full md:w-auto">Filtros Avan√ßados:</h2>

        <!-- Filtro por Colaborador -->
        <div class="flex flex-col w-full sm:w-auto flex-1 min-w-[200px]">
            <label for="filter-colaborador" class="text-sm font-medium text-gray-600 mb-1">Filtrar por Colaborador</label>
            <select id="filter-colaborador" onchange="filterCards()" class="p-2 border-2 border-gray-200 rounded-xl focus:ring-slate-500 focus:border-slate-500 transition duration-200 shadow-inner">
                <option value="todos" class="font-bold">Todos os Colaboradores</option>
                <!-- Op√ß√µes preenchidas pelo JS -->
            </select>
        </div>

        <!-- Filtro por Data (Calend√°rio) -->
        <div class="flex flex-col w-full sm:w-auto flex-1 min-w-[200px]">
            <label for="filter-date" class="text-sm font-medium text-gray-600 mb-1">Filtrar por Data (Registro/Previs√£o)</label>
            <input type="date" id="filter-date" onchange="filterCards()" class="p-2 border-2 border-gray-200 rounded-xl focus:ring-slate-500 focus:border-slate-500 transition duration-200 shadow-inner">
        </div>

        <!-- Bot√£o Limpar Filtros -->
        <button onclick="clearFilters()" class="bg-gray-700 text-white hover:bg-gray-800 px-4 py-2 rounded-xl font-semibold transition duration-200 shadow-md min-h-[44px] w-full sm:w-auto">
            Limpar Filtros
        </button>
    </div>

    <!-- Dashboard Kanban com melhor visualiza√ß√£o -->
    <div class="flex space-x-6 overflow-x-auto pb-6">
        
        <!-- Coluna 1: Em Tratamento (Muted Amber) -->
        <div id="column-tratamento" class="board-column bg-white p-5 rounded-2xl shadow-xl">
            <h3 class="text-xl font-extrabold text-amber-700 border-b-4 border-amber-300 pb-3 mb-4 flex items-center">
                <span class="mr-2 text-2xl">üî•</span> Em Tratamento
            </h3>
            <!-- Cards inseridos aqui pelo JS -->
        </div>

        <!-- Coluna 2: Tratados na Semana (Muted Emerald) -->
        <div id="column-tratados" class="board-column bg-white p-5 rounded-2xl shadow-xl">
            <h3 class="text-xl font-extrabold text-emerald-600 border-b-4 border-emerald-300 pb-3 mb-4 flex items-center">
                <span class="mr-2 text-2xl">‚ú®</span> Tratados na Semana
            </h3>
            <!-- Cards inseridos aqui pelo JS -->
        </div>

        <!-- Coluna 3: Pr√≥ximos Processos (Soft Sky Blue) -->
        <div id="column-proximos" class="board-column bg-white p-5 rounded-2xl shadow-xl">
            <h3 class="text-xl font-extrabold text-sky-600 border-b-4 border-sky-300 pb-3 mb-4 flex items-center">
                <span class="mr-2 text-2xl">üöÄ</span> Pr√≥ximos Processos
            </h3>
            <!-- Cards inseridos aqui pelo JS -->
        </div>
        
    </div>

    <!-- Formul√°rio de Entrada de Dados com estilo aprimorado -->
    <div class="bg-white rounded-xl shadow-2xl p-6 mt-8 border-l-8 border-slate-500">
        <h2 class="text-2xl font-black text-gray-800 mb-6 border-b pb-2">‚úçÔ∏è Registrar Novo Processo</h2>
        <form id="process-form" class="grid grid-cols-1 md:grid-cols-3 gap-6">
            
            <!-- Campo Colaborador -->
            <div class="col-span-1">
                <label for="colaborador" class="block text-sm font-semibold text-gray-700">Colaborador</label>
                <select id="colaborador" required class="mt-1 block w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-slate-500 focus:border-slate-500 transition duration-150 bg-gray-50">
                    <!-- Op√ß√µes preenchidas pelo JS -->
                </select>
            </div>

            <!-- Campo Status -->
            <div class="col-span-1">
                <label for="processo-status" class="block text-sm font-semibold text-gray-700">Status do Processo</label>
                <select id="processo-status" required class="mt-1 block w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-slate-500 focus:border-slate-500 transition duration-150 bg-gray-50">
                    <option value="tratamento">Em Tratamento</option>
                    <option value="tratados">Tratados na Semana</option>
                    <option value="proximos">Pr√≥ximos Processos</option>
                </select>
            </div>

            <!-- Campo Data -->
            <div class="col-span-1">
                <label for="data-registro" class="block text-sm font-semibold text-gray-700">Data de Registro/Previs√£o</label>
                <input type="date" id="data-registro" required class="mt-1 block w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-slate-500 focus:border-slate-500 transition duration-150 bg-gray-50">
            </div>
            
            <!-- Campo Nome do Processo -->
            <div class="col-span-1 md:col-span-3">
                <label for="processo-nome" class="block text-sm font-semibold text-gray-700">Nome do Processo/Tarefa</label>
                <input type="text" id="processo-nome" required class="mt-1 block w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-slate-500 focus:border-slate-500" placeholder="Ex: Fechamento mensal Cliente Alpha">
            </div>

            <!-- Campo Detalhes -->
            <div class="col-span-1 md:col-span-3">
                <label for="detalhes" class="block text-sm font-semibold text-gray-700">Detalhes/Descri√ß√£o</label>
                <textarea id="detalhes" class="mt-1 block w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-slate-500 focus:border-slate-500 h-24" placeholder="O que est√° sendo feito ou o que foi/ser√° feito..."></textarea>
            </div>
            
            <!-- Bot√£o Adicionar (Cor prim√°ria Slate) -->
            <div class="col-span-1 md:col-span-3 text-right">
                <button type="submit" class="bg-slate-600 hover:bg-slate-700 text-white font-bold py-3 px-6 rounded-xl shadow-lg hover:shadow-xl transition duration-200 transform hover:scale-[1.02]">
                    Adicionar Processo
                </button>
            </div>
        </form>
    </div>

    <!-- L√ìGICA JAVASCRIPT -->
    <script>
        // Lista de colaboradores em ordem alfab√©tica
        const colaboradores = [
            'Beatriz', 'Diego', 'Emily', 'Felipe', 'Hosana', 
            'Jo√£o', 'Mariane', 'Rebeca', 'Tairane', 'Thais'
        ];

        let processos = [];

        // ------------------ Fun√ß√µes de Persist√™ncia (localStorage) ------------------

        function saveProcesses() {
            try {
                localStorage.setItem('processosDashboard', JSON.stringify(processos));
            } catch (e) {
                console.error("Erro ao salvar dados no localStorage:", e);
                console.error("ERRO: N√£o foi poss√≠vel salvar os dados. Verifique as configura√ß√µes do seu navegador."); 
            }
        }

        function loadProcesses() {
            try {
                const storedProcesses = localStorage.getItem('processosDashboard');
                if (storedProcesses) {
                    processos = JSON.parse(storedProcesses);
                }
            } catch (e) {
                console.error("Erro ao carregar dados do localStorage:", e);
                processos = []; // Limpa dados em caso de erro de parsing
            }
        }
        
        // ------------------ Fun√ß√µes de UI ------------------

        function setupCollaboratorSelects() {
            const selects = [
                document.getElementById('filter-colaborador'),
                document.getElementById('colaborador')
            ];

            colaboradores.forEach(nome => {
                const option = document.createElement('option');
                option.value = nome;
                option.textContent = nome;

                // Adiciona a op√ß√£o de filtro (al√©m do "Todos")
                selects[0].appendChild(option.cloneNode(true)); 
                // Adiciona a op√ß√£o no formul√°rio de cadastro
                selects[1].appendChild(option); 
            });
        }

        function createCard(processo) {
            const card = document.createElement('div');
            // Classes Tailwind para visual
            card.className = `task-card bg-white p-4 rounded-xl shadow-lg mb-4 text-sm status-${processo.status}`;
            
            // Atributos para facilitar a filtragem
            card.setAttribute('data-colaborador', processo.colaborador);
            card.setAttribute('data-data', processo.data);
            card.setAttribute('data-status', processo.status);

            // Formata√ß√£o da data para BR
            const dataFormatada = new Date(processo.data).toLocaleDateString('pt-BR');

            card.innerHTML = `
                <div class="flex justify-between items-start mb-2">
                    <div class="font-extrabold text-gray-800 text-base">${processo.nome}</div>
                    <!-- Bot√£o de Exclus√£o -->
                    <button onclick="deleteProcess(${processo.id})" title="Excluir Processo" class="text-gray-400 hover:text-red-600 transition duration-150 p-1 rounded-full focus:outline-none">
                        <!-- √çcone de Lixeira (Trash Icon SVG) -->
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                        </svg>
                    </button>
                </div>
                <div class="flex justify-between items-center mb-2">
                    <div class="text-xs text-gray-500">Colab: <span class="font-bold text-gray-700">${processo.colaborador}</span></div>
                    <span class="card-date text-xs">${dataFormatada}</span>
                </div>
                <div class="text-gray-600 whitespace-pre-wrap mt-3 pt-3 border-t border-gray-100">${processo.detalhes}</div>
            `;
            return card;
        }

        function renderDashboard() {
            // Limpa as colunas e recria os t√≠tulos com os √≠cones atualizados (com novas cores neutras)
            document.getElementById('column-tratamento').innerHTML = '<h3 class="text-xl font-extrabold text-amber-700 border-b-4 border-amber-300 pb-3 mb-4 flex items-center"><span class="mr-2 text-2xl">üî•</span> Em Tratamento</h3>';
            document.getElementById('column-tratados').innerHTML = '<h3 class="text-xl font-extrabold text-emerald-600 border-b-4 border-emerald-300 pb-3 mb-4 flex items-center"><span class="mr-2 text-2xl">‚ú®</span> Tratados na Semana</h3>';
            document.getElementById('column-proximos').innerHTML = '<h3 class="text-xl font-extrabold text-sky-600 border-b-4 border-sky-300 pb-3 mb-4 flex items-center"><span class="mr-2 text-2xl">üöÄ</span> Pr√≥ximos Processos</h3>';

            // Renderiza os cards nas colunas corretas
            processos.forEach(processo => {
                const card = createCard(processo);
                let targetColumn;
                
                switch (processo.status) {
                    case 'tratamento':
                        targetColumn = document.getElementById('column-tratamento');
                        break;
                    case 'tratados':
                        targetColumn = document.getElementById('column-tratados');
                        break;
                    case 'proximos':
                        targetColumn = document.getElementById('column-proximos');
                        break;
                }
                
                if (targetColumn) {
                    targetColumn.appendChild(card);
                }
            });
            filterCards(); // Aplica os filtros atuais ap√≥s a renderiza√ß√£o
        }

        // ------------------ Fun√ß√µes de A√ß√£o (Excluir) ------------------

        function deleteProcess(id) {
            // Filtra a lista, mantendo apenas os processos que N√ÉO t√™m o ID fornecido
            const initialLength = processos.length;
            processos = processos.filter(processo => processo.id !== id);

            if (processos.length < initialLength) {
                saveProcesses();
                renderDashboard();
                console.log(`Processo com ID ${id} exclu√≠do com sucesso.`);
            } else {
                console.warn(`Processo com ID ${id} n√£o encontrado.`);
            }
        }

        // ------------------ Fun√ß√µes de Filtro ------------------
        
        function filterCards() {
            const filterColab = document.getElementById('filter-colaborador').value;
            const filterDate = document.getElementById('filter-date').value;
            const allCards = document.querySelectorAll('.task-card');

            allCards.forEach(card => {
                const cardColab = card.getAttribute('data-colaborador');
                const cardDate = card.getAttribute('data-data');
                let matches = true;

                // 1. Filtro por Colaborador
                if (filterColab !== 'todos' && cardColab !== filterColab) {
                    matches = false;
                }

                // 2. Filtro por Data (se a data do filtro for definida, deve corresponder √† data do card)
                if (filterDate && cardDate !== filterDate) {
                    matches = false;
                }

                card.style.display = matches ? 'block' : 'none';
            });
        }
        
        function clearFilters() {
            document.getElementById('filter-colaborador').value = 'todos';
            document.getElementById('filter-date').value = '';
            filterCards();
        }

        // ------------------ Manipula√ß√£o do Formul√°rio ------------------

        document.getElementById('process-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const novoProcesso = {
                colaborador: document.getElementById('colaborador').value,
                status: document.getElementById('processo-status').value,
                nome: document.getElementById('processo-nome').value,
                data: document.getElementById('data-registro').value,
                detalhes: document.getElementById('detalhes').value || 'Nenhum detalhe fornecido.',
                id: Date.now() // ID √∫nico
            };

            processos.push(novoProcesso);
            saveProcesses();
            renderDashboard();
            
            // Limpa campos espec√≠ficos do formul√°rio
            document.getElementById('processo-nome').value = '';
            document.getElementById('data-registro').value = '';
            document.getElementById('detalhes').value = '';
            
            console.log(`Processo "${novoProcesso.nome}" adicionado para ${novoProcesso.colaborador}!`);
        });

        // ------------------ Inicializa√ß√£o ------------------
        
        // Define alguns dados iniciais se n√£o houver nada salvo no localStorage
        function setInitialData() {
            if (processos.length === 0) {
                // Ajustando as datas de exemplo para que o filtro de calend√°rio funcione bem
                const today = new Date().toISOString().split('T')[0];
                const yesterday = new Date(Date.now() - 86400000).toISOString().split('T')[0];
                const nextWeek = new Date(Date.now() + 7 * 86400000).toISOString().split('T')[0];

                processos = [
                    { colaborador: 'Beatriz', status: 'tratamento', nome: 'An√°lise de Relat√≥rio de Custos', data: today, detalhes: 'Revisando as despesas de TI e Pessoal. Prioridade alta.', id: 1 },
                    { colaborador: 'Diego', status: 'tratados', nome: 'Migra√ß√£o de Servidor Cloud', data: yesterday, detalhes: 'Migra√ß√£o para novo ambiente AWS conclu√≠da com sucesso.', id: 2 },
                    { colaborador: 'Emily', status: 'proximos', nome: 'Planejamento de Campanha Q4', data: nextWeek, detalhes: 'Definir budget, criar criativos e segmentar p√∫blico-alvo.', id: 3 },
                    { colaborador: 'Jo√£o', status: 'tratamento', nome: 'Atendimento Cliente Y (Chamado 456)', data: today, detalhes: 'Aguardando feedback do cliente sobre a proposta enviada.', id: 4 },
                ];
            }
        }


        document.addEventListener('DOMContentLoaded', () => {
            setupCollaboratorSelects(); // Popula os <select>
            loadProcesses(); // Carrega dados salvos
            setInitialData(); // Adiciona dados de exemplo se n√£o houver dados salvos
            renderDashboard(); // Renderiza a tela
        });

    </script>
</body>
</html>
